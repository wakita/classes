#!/Users/wakita/.venvs/web/bin/python3

from pathlib import Path

import gspread
import pandas as pd

ROOT = Path(__file__).parent.parent

def download():
  gc = gspread.service_account()
  book = gc.open_by_key('1t2kBsojDQkdy40z7RhVIhx3rhS9t86GCsIPEiT2MieY')
  sheets = book.worksheets()
  b = {}
  for sheet in sheets:
    with open(ROOT.joinpath('_data', sheet.title + '.csv'), 'w') as w:
      pd.DataFrame(sheet.get_all_records()).to_csv(w, encoding='utf-8')

if __name__ == '__main__':
  download()

# vi: ft=python sw=2
